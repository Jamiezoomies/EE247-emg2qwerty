submitit INFO (2025-02-25 07:36:14,447) - Starting with JobEnvironment(job_id=3841, hostname=a5a59fd123c2, local_rank=0(1), node=0(1), global_rank=0(1))
submitit INFO (2025-02-25 07:36:14,448) - Loading pickle: /content/drive/MyDrive/projects/emg2qwerty-main/logs/2025-02-25/07-36-13/submitit_logs/3841/3841_submitted.pkl
[2025-02-25 07:36:25,156][__main__][INFO] - 
Config:
user: single_user
dataset:
  train:
  - user: 89335547
    session: 2021-06-03-1622765527-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-02-1622681518-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-04-1622863166-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-07-22-1627003020-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-07-21-1626916256-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-07-22-1627004019-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-05-1622885888-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-02-1622679967-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-03-1622764398-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-07-21-1626917264-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-05-1622889105-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-03-1622766673-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-04-1622861066-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-07-22-1627001995-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-06-05-1622884635-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  - user: 89335547
    session: 2021-07-21-1626915176-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  val:
  - user: 89335547
    session: 2021-06-04-1622862148-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  test:
  - user: 89335547
    session: 2021-06-02-1622682789-keystrokes-dca-study@1-0efbe614-9ae6-4131-9192-4398359b4f5f
  root: ${hydra:runtime.cwd}/data
to_tensor:
  _target_: emg2qwerty.transforms.ToTensor
  fields:
  - emg_left
  - emg_right
band_rotation:
  _target_: emg2qwerty.transforms.ForEach
  transform:
    _target_: emg2qwerty.transforms.RandomBandRotation
    offsets:
    - -1
    - 0
    - 1
temporal_jitter:
  _target_: emg2qwerty.transforms.TemporalAlignmentJitter
  max_offset: 120
logspec:
  _target_: emg2qwerty.transforms.LogSpectrogram
  n_fft: 64
  hop_length: 16
specaug:
  _target_: emg2qwerty.transforms.SpecAugment
  n_time_masks: 3
  time_mask_param: 25
  n_freq_masks: 2
  freq_mask_param: 4
transforms:
  train:
  - ${to_tensor}
  - ${band_rotation}
  - ${temporal_jitter}
  - ${logspec}
  - ${specaug}
  val:
  - ${to_tensor}
  - ${logspec}
  test: ${transforms.val}
module:
  _target_: emg2qwerty.lightning.TDSConvCTCModule
  in_features: 528
  mlp_features:
  - 384
  block_channels:
  - 24
  - 24
  - 24
  - 24
  kernel_width: 32
datamodule:
  _target_: emg2qwerty.lightning.WindowedEMGDataModule
  window_length: 8000
  padding:
  - 1800
  - 200
optimizer:
  _target_: torch.optim.Adam
  lr: 0.001
lr_scheduler:
  scheduler:
    _target_: pl_bolts.optimizers.lr_scheduler.LinearWarmupCosineAnnealingLR
    warmup_epochs: 10
    max_epochs: ${trainer.max_epochs}
    warmup_start_lr: 1.0e-08
    eta_min: 1.0e-06
  interval: epoch
decoder:
  _target_: emg2qwerty.decoder.CTCGreedyDecoder
seed: 1501
batch_size: 32
num_workers: 4
train: true
checkpoint: null
monitor_metric: val/CER
monitor_mode: min
trainer:
  accelerator: gpu
  devices: 1
  num_nodes: 1
  max_epochs: 150
  default_root_dir: ${hydra:runtime.output_dir}
callbacks:
- _target_: pytorch_lightning.callbacks.LearningRateMonitor
- _target_: pytorch_lightning.callbacks.ModelCheckpoint
  dirpath: ${hydra:runtime.output_dir}/checkpoints
  monitor: ${monitor_metric}
  mode: ${monitor_mode}
  save_last: true
  verbose: true

[2025-02-25 07:36:25,163][__main__][INFO] - Instantiating LightningModule {'_target_': 'emg2qwerty.lightning.TDSConvCTCModule', 'in_features': 528, 'mlp_features': [384], 'block_channels': [24, 24, 24, 24], 'kernel_width': 32}
[2025-02-25 07:36:27,179][__main__][INFO] - Instantiating LightningDataModule {'_target_': 'emg2qwerty.lightning.WindowedEMGDataModule', 'window_length': 8000, 'padding': [1800, 200]}
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.05s/it]                                                                           Training: 0it [00:00, ?it/s]Training:   0%|          | 0/127 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/127 [00:00<?, ?it/s] Epoch 0:  16%|â–ˆâ–Œ        | 20/127 [02:15<12:07,  6.80s/it]Epoch 0:  16%|â–ˆâ–Œ        | 20/127 [02:16<12:08,  6.81s/it, loss=123, v_num=0]Epoch 0:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [02:38<05:44,  3.96s/it, loss=123, v_num=0]Epoch 0:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [02:38<05:44,  3.96s/it, loss=124, v_num=0]Epoch 0:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [02:59<03:20,  3.00s/it, loss=124, v_num=0]Epoch 0:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [03:00<03:21,  3.00s/it, loss=118, v_num=0]Epoch 0:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [03:18<01:56,  2.49s/it, loss=118, v_num=0]Epoch 0:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [03:19<01:56,  2.49s/it, loss=121, v_num=0]Epoch 0:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [03:39<00:59,  2.19s/it, loss=121, v_num=0]Epoch 0:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [03:39<00:59,  2.19s/it, loss=133, v_num=0]Epoch 0:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [03:55<00:13,  1.96s/it, loss=133, v_num=0]Epoch 0:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [03:55<00:13,  1.96s/it, loss=122, v_num=0]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:02<00:00,  3.02it/s][AEpoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [04:00<00:00,  1.89s/it, loss=122, v_num=0]Epoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [04:00<00:00,  1.89s/it, loss=122, v_num=0]
                                                                      [AEpoch 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [04:00<00:00,  1.89s/it, loss=122, v_num=0]Epoch 0:   0%|          | 0/127 [00:00<?, ?it/s, loss=122, v_num=0]          Epoch 1:   0%|          | 0/127 [00:00<?, ?it/s, loss=122, v_num=0]Epoch 1:  16%|â–ˆâ–Œ        | 20/127 [00:20<01:51,  1.04s/it, loss=122, v_num=0]Epoch 1:  16%|â–ˆâ–Œ        | 20/127 [00:21<01:53,  1.06s/it, loss=27.7, v_num=0]Epoch 1:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:38<01:23,  1.04it/s, loss=27.7, v_num=0]Epoch 1:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:38<01:24,  1.03it/s, loss=6.41, v_num=0]Epoch 1:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:55<01:01,  1.09it/s, loss=6.41, v_num=0]Epoch 1:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:55<01:01,  1.08it/s, loss=3.89, v_num=0]Epoch 1:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:11<00:42,  1.12it/s, loss=3.89, v_num=0]Epoch 1:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:11<00:42,  1.11it/s, loss=3.63, v_num=0]Epoch 1:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [01:28<00:23,  1.13it/s, loss=3.63, v_num=0]Epoch 1:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [01:29<00:24,  1.12it/s, loss=3.52, v_num=0]Epoch 1:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [01:45<00:06,  1.14it/s, loss=3.52, v_num=0]Epoch 1:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [01:45<00:06,  1.13it/s, loss=3.43, v_num=0]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:02<00:00,  3.18it/s][AEpoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:51<00:00,  1.14it/s, loss=3.43, v_num=0]Epoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:51<00:00,  1.14it/s, loss=3.43, v_num=0]
                                                                      [AEpoch 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:51<00:00,  1.14it/s, loss=3.43, v_num=0]Epoch 1:   0%|          | 0/127 [00:00<?, ?it/s, loss=3.43, v_num=0]          Epoch 2:   0%|          | 0/127 [00:00<?, ?it/s, loss=3.43, v_num=0]Epoch 2:  16%|â–ˆâ–Œ        | 20/127 [00:21<01:55,  1.08s/it, loss=3.43, v_num=0]Epoch 2:  16%|â–ˆâ–Œ        | 20/127 [00:21<01:56,  1.09s/it, loss=3.49, v_num=0]Epoch 2:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:40<01:27,  1.00s/it, loss=3.49, v_num=0]Epoch 2:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:40<01:27,  1.01s/it, loss=3.42, v_num=0]Epoch 2:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:57<01:04,  1.04it/s, loss=3.42, v_num=0]Epoch 2:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:57<01:04,  1.04it/s, loss=3.36, v_num=0]Epoch 2:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:15<00:44,  1.06it/s, loss=3.36, v_num=0]Epoch 2:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:15<00:44,  1.06it/s, loss=3.34, v_num=0]Epoch 2:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [01:32<00:24,  1.08it/s, loss=3.34, v_num=0]Epoch 2:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [01:32<00:24,  1.08it/s, loss=3.26, v_num=0]Epoch 2:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [01:48<00:06,  1.11it/s, loss=3.26, v_num=0]Epoch 2:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [01:48<00:06,  1.10it/s, loss=3.25, v_num=0]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:03<00:00,  2.32it/s][AEpoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:55<00:00,  1.10it/s, loss=3.25, v_num=0]Epoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:55<00:00,  1.10it/s, loss=3.25, v_num=0]
                                                                      [AEpoch 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:55<00:00,  1.10it/s, loss=3.25, v_num=0]Epoch 2:   0%|          | 0/127 [00:00<?, ?it/s, loss=3.25, v_num=0]          Epoch 3:   0%|          | 0/127 [00:00<?, ?it/s, loss=3.25, v_num=0]Epoch 3:  16%|â–ˆâ–Œ        | 20/127 [00:19<01:46,  1.00it/s, loss=3.25, v_num=0]Epoch 3:  16%|â–ˆâ–Œ        | 20/127 [00:20<01:48,  1.01s/it, loss=3.27, v_num=0]Epoch 3:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:36<01:19,  1.10it/s, loss=3.27, v_num=0]Epoch 3:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:36<01:19,  1.09it/s, loss=3.23, v_num=0]Epoch 3:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:53<00:59,  1.12it/s, loss=3.23, v_num=0]Epoch 3:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:53<01:00,  1.11it/s, loss=3.26, v_num=0]Epoch 3:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:11<00:41,  1.12it/s, loss=3.26, v_num=0]Epoch 3:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:11<00:42,  1.12it/s, loss=3.31, v_num=0]Epoch 3:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [01:29<00:24,  1.11it/s, loss=3.31, v_num=0]Epoch 3:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 100/127 [01:30<00:24,  1.11it/s, loss=3.36, v_num=0]Epoch 3:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [01:46<00:06,  1.13it/s, loss=3.36, v_num=0]Epoch 3:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 120/127 [01:46<00:06,  1.13it/s, loss=3.21, v_num=0]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:01<00:00,  3.89it/s][AEpoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:51<00:00,  1.14it/s, loss=3.21, v_num=0]Epoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:51<00:00,  1.14it/s, loss=3.21, v_num=0]
                                                                      [AEpoch 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 127/127 [01:51<00:00,  1.14it/s, loss=3.21, v_num=0]Epoch 3:   0%|          | 0/127 [00:00<?, ?it/s, loss=3.21, v_num=0]          Epoch 4:   0%|          | 0/127 [00:00<?, ?it/s, loss=3.21, v_num=0]Epoch 4:  16%|â–ˆâ–Œ        | 20/127 [00:21<01:52,  1.06s/it, loss=3.21, v_num=0]Epoch 4:  16%|â–ˆâ–Œ        | 20/127 [00:21<01:54,  1.07s/it, loss=3.28, v_num=0]Epoch 4:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:38<01:22,  1.05it/s, loss=3.28, v_num=0]Epoch 4:  31%|â–ˆâ–ˆâ–ˆâ–      | 40/127 [00:38<01:23,  1.04it/s, loss=3.24, v_num=0]Epoch 4:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:56<01:03,  1.05it/s, loss=3.24, v_num=0]Epoch 4:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 60/127 [00:57<01:03,  1.05it/s, loss=3.15, v_num=0]Epoch 4:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:16<00:44,  1.05it/s, loss=3.15, v_num=0]Epoch 4:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 80/127 [01:16<00:44,  1.05it/s, loss=3.14, v_num=0]